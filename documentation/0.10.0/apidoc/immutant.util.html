<!DOCTYPE html>
<html><head><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>immutant.util documentation</title></head><body><div id="header"><h2><a href="../index.html">Immutant Manual</a></h2><h2><a href="http://immutant.org/">Immutant Home</a></h2><h1><a href="index.html">Immutant 0.10.0 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><span>Namespaces</span></h3><ul><li><a href="immutant.cache.html"><span>immutant.cache</span></a></li><li><a href="immutant.codecs.html"><span>immutant.codecs</span></a></li><li><a href="immutant.daemons.html"><span>immutant.daemons</span></a></li><li><a href="immutant.dev.html"><span>immutant.dev</span></a></li><li><a href="immutant.jobs.html"><span>immutant.jobs</span></a></li><li><a href="immutant.messaging.html"><span>immutant.messaging</span></a></li><li><a href="immutant.pipeline.html"><span>immutant.pipeline</span></a></li><li><a href="immutant.registry.html"><span>immutant.registry</span></a></li><li><a href="immutant.repl.html"><span>immutant.repl</span></a></li><li class="current"><a href="immutant.util.html"><span>immutant.util</span></a></li><li><a href="immutant.web.html"><span>immutant.web</span></a></li><li><a href="immutant.web.session.html"><span>immutant.web.session</span></a></li><li><a href="immutant.xa.html"><span>immutant.xa</span></a></li><li><a href="immutant.xa.transaction.html"><span>immutant.xa.transaction</span></a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="immutant.util.html#var-app-name"><span class="">app-name</span></a></li><li><a href="immutant.util.html#var-app-relative"><span class="">app-relative</span></a></li><li><a href="immutant.util.html#var-app-root"><span class="">app-root</span></a></li><li><a href="immutant.util.html#var-app-uri"><span class="">app-uri</span></a></li><li><a href="immutant.util.html#var-at-exit"><span class="">at-exit</span></a></li><li><a href="immutant.util.html#var-backoff"><span class="">backoff</span></a></li><li><a href="immutant.util.html#var-context-path"><span class="">context-path</span></a></li><li><a href="immutant.util.html#var-http-port"><span class="">http-port</span></a></li><li><a href="immutant.util.html#var-if-in-immutant"><span class="">if-in-immutant</span></a></li><li><a href="immutant.util.html#var-in-immutant%3F"><span class="">in-immutant?</span></a></li><li><a href="immutant.util.html#var-management-interface-address"><span class="">management-interface-address</span></a></li><li><a href="immutant.util.html#var-maybe-deref"><span class="">maybe-deref</span></a></li><li><a href="immutant.util.html#var-public-interface-address"><span class="">public-interface-address</span></a></li><li><a href="immutant.util.html#var-try-resolve"><span class="">try-resolve</span></a></li><li><a href="immutant.util.html#var-try-resolve-any"><span class="">try-resolve-any</span></a></li><li><a href="immutant.util.html#var-unsecure-interface-address"><span class="">unsecure-interface-address</span></a></li><li><a href="immutant.util.html#var-wait-for"><span class="">wait-for</span></a></li><li><a href="immutant.util.html#var-wait-for-start"><span class="">wait-for-start</span></a></li><li><a href="immutant.util.html#var-waiting-derefable"><span class="">waiting-derefable</span></a></li></ul></div><div class="namespace-docs" id="content"><h2>immutant.util documentation</h2><pre class="doc">Various utility functions.
</pre><div class="public " id="var-app-name"><h3>app-name</h3><div class="usage"><code>(app-name)</code></div><pre class="doc">Returns the internal name for the app as Immutant sees it
</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L42">Source</a></div></div><div class="public " id="var-app-relative"><h3>app-relative</h3><div class="usage"><code>(app-relative &amp; path)</code></div><pre class="doc">Returns a file relative to app-root
</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L47">Source</a></div></div><div class="public " id="var-app-root"><h3>app-root</h3><div class="usage"><code>(app-root)</code></div><pre class="doc">Returns a file pointing to the root dir of the application
</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L37">Source</a></div></div><div class="public " id="var-app-uri"><h3>app-uri</h3><div class="usage"><code>(app-uri &amp; [host])</code></div><pre class="doc">Returns the base URI for the app, given a host [localhost]
</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L94">Source</a></div></div><div class="public " id="var-at-exit"><h3>at-exit</h3><div class="usage"><code>(at-exit f)</code></div><pre class="doc">Registers a function to be called when the application is undeployed.
Used internally to shutdown various services, but can be used by
application code as well.</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L53">Source</a></div></div><div class="public " id="var-backoff"><h3>backoff</h3><h4 class="type">macro</h4><div class="usage"><code>(backoff start end &amp; body)</code></div><pre class="doc">A simple backoff strategy that retries body in the event of error.
The first retry occurs after sleeping start milliseconds, the next
after start*2 ms, and so on, until the sleep time exceeds end ms,
at which point the caught error is tossed.</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L137">Source</a></div></div><div class="public " id="var-context-path"><h3>context-path</h3><div class="usage"><code>(context-path)</code></div><pre class="doc">Returns the HTTP context path for the deployed app
</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L88">Source</a></div></div><div class="public " id="var-http-port"><h3>http-port</h3><div class="usage"><code>(http-port)</code></div><pre class="doc">Returns the HTTP port for the embedded web server
</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L82">Source</a></div></div><div class="public " id="var-if-in-immutant"><h3>if-in-immutant</h3><h4 class="type">macro</h4><div class="usage"><code>(if-in-immutant yes no)</code></div><pre class="doc">Executes the 'yes' branch if inside immutant, the 'no' branch otherwise.
</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L30">Source</a></div></div><div class="public " id="var-in-immutant%3F"><h3>in-immutant?</h3><div class="usage"><code>(in-immutant?)</code></div><pre class="doc">Returns true if running inside an Immutant container
</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L25">Source</a></div></div><div class="public " id="var-management-interface-address"><h3>management-interface-address</h3><div class="usage"></div><pre class="doc">Looks up the ip address for the AS management interface.
</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L70">Source</a></div></div><div class="public " id="var-maybe-deref"><h3>maybe-deref</h3><div class="usage"><code>(maybe-deref v &amp; args)</code></div><pre class="doc">derefs v if it is derefable, otherwise returns v
</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L193">Source</a></div></div><div class="public " id="var-public-interface-address"><h3>public-interface-address</h3><div class="usage"></div><pre class="doc">Looks up the ip address for the AS public interface.
</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L74">Source</a></div></div><div class="public " id="var-try-resolve"><h3>try-resolve</h3><div class="usage"><code>(try-resolve sym)</code></div><pre class="doc">Tries to resolve the given namespace-qualified symbol
</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L112">Source</a></div></div><div class="public " id="var-try-resolve-any"><h3>try-resolve-any</h3><div class="usage"><code>(try-resolve-any &amp; syms)</code></div><pre class="doc">Tries to resolve the given namespace-qualified symbols. Returns the
first successfully resolved symbol, or nil if none of the given symbols
resolve.</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L121">Source</a></div></div><div class="public " id="var-unsecure-interface-address"><h3>unsecure-interface-address</h3><div class="usage"></div><pre class="doc">Looks up the ip address for the AS unsecure interface.
</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L78">Source</a></div></div><div class="public " id="var-wait-for"><h3>wait-for</h3><div class="usage"><code>(wait-for t f)</code><code>(wait-for t f attempts)</code></div><pre class="doc">Waits for (t) to be true before invoking f. Evaluates test every
100 ms attempts times before giving up. attempts defaults to 300.
Passing :forever for attempts will loop until the end of time
or (t) is true, whichever comes first.</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L149">Source</a></div></div><div class="public " id="var-wait-for-start"><h3>wait-for-start</h3><div class="usage"><code>(wait-for-start x)</code><code>(wait-for-start x f)</code><code>(wait-for-start x f attempts)</code></div><pre class="doc">Waits for (.isStarted x) to be true before returning or invoking f.
</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L169">Source</a></div></div><div class="public " id="var-waiting-derefable"><h3>waiting-derefable</h3><div class="usage"><code>(waiting-derefable t x)</code></div><pre class="doc">Returns an IDeref/IBlockingDeref that completes the deref and returns x when 
(t) is true.</pre><div class="src-link"><a href="https://github.com/immutant/immutant/tree/0.10.0//namespaces/common/src/main/clojure/immutant/util.clj#L178">Source</a></div></div></div></body></html>